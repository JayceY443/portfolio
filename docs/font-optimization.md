# å­—ä½“ä¼˜åŒ–è‡ªåŠ¨åŒ–æµç¨‹

æœ¬é¡¹ç›®å®ç°äº†è‡ªåŠ¨åŒ–çš„ä¸­æ–‡å­—ä½“å­é›†åŒ–ä¼˜åŒ–ï¼Œåœ¨æ¯æ¬¡æ„å»ºæ—¶è‡ªåŠ¨æå–ç½‘ç«™ä½¿ç”¨çš„å­—ç¬¦å¹¶ç”Ÿæˆä¼˜åŒ–çš„å­—ä½“æ–‡ä»¶ã€‚

## ğŸ¯ ä¼˜åŒ–æ•ˆæœ

- **åŸå§‹å­—ä½“**: 24.8MB (Medium: 12.3MB + Bold: 12.5MB)
- **ä¼˜åŒ–å**: 259KB (Medium: 127KB + Bold: 132KB)
- **å‹ç¼©ç‡**: **99%** - å‡å°‘äº† **95å€**!
- **åŠ è½½é€Ÿåº¦**: ä»8ç§’æå‡è‡³0.3ç§’

## ğŸ”§ å·¥ä½œåŸç†

### 1. è‡ªåŠ¨å­—ç¬¦æå–
- æ‰«æ `src/` ç›®å½•ä¸‹æ‰€æœ‰ `.tsx`ã€`.ts`ã€`.jsx`ã€`.js`ã€`.md`ã€`.mdx` æ–‡ä»¶
- æå–æ‰€æœ‰ä¸­æ–‡å­—ç¬¦ (U+4E00-U+9FFF)
- åŒ…å«ä¸­æ–‡æ ‡ç‚¹ç¬¦å· (U+3000-U+303F)
- åŒ…å«å…¨è§’å­—ç¬¦ (U+FF00-U+FFEF)
- åŒ…å«åŸºæœ¬ASCIIå­—ç¬¦ (U+0020-U+007E)

### 2. å­—ä½“å­é›†åŒ–
- ä½¿ç”¨ `pyftsubset` å·¥å…·ç”Ÿæˆå­—ä½“å­é›†
- è¾“å‡ºæ ¼å¼ï¼šWOFF2 (æœ€ä½³å‹ç¼©ç‡)
- åªåŒ…å«ç½‘ç«™å®é™…ä½¿ç”¨çš„å­—ç¬¦

### 3. è‡ªåŠ¨é›†æˆ
- æ„å»ºå‰è‡ªåŠ¨è¿è¡Œå­—ä½“ä¼˜åŒ–
- CI/CD è‡ªåŠ¨å®‰è£…ä¾èµ–å’Œæ‰§è¡Œ
- ç”Ÿæˆçš„æ–‡ä»¶è‡ªåŠ¨è¢« `.gitignore` å¿½ç•¥

## ğŸ“ æ–‡ä»¶ç»“æ„

```
portfolio/
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ build-font-subset.mjs    # å­—ä½“å­é›†åŒ–è„šæœ¬
â”œâ”€â”€ public/fonts/
â”‚   â”œâ”€â”€ SourceHanSerifCN-*.otf   # åŸå§‹å­—ä½“æ–‡ä»¶
â”‚   â””â”€â”€ subset/                  # ç”Ÿæˆçš„å­é›†å­—ä½“ (è‡ªåŠ¨ç”Ÿæˆ)
â”‚       â”œâ”€â”€ SourceHanSerifCN-Medium-subset.woff2
â”‚       â””â”€â”€ SourceHanSerifCN-Bold-subset.woff2
â””â”€â”€ docs/
    â””â”€â”€ font-optimization.md     # æœ¬æ–‡æ¡£
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### å¼€å‘ç¯å¢ƒ

```bash
# å•ç‹¬è¿è¡Œå­—ä½“ä¼˜åŒ–
npm run build:fonts

# å®Œæ•´æ„å»º (åŒ…å«å­—ä½“ä¼˜åŒ–)
npm run build

# å¼€å‘æ¨¡å¼ (ä¸ä¼šè¿è¡Œå­—ä½“ä¼˜åŒ–)
npm run dev
```

### æ·»åŠ æ–°å­—ç¬¦
å½“æ‚¨åœ¨ä»£ç ä¸­æ·»åŠ æ–°çš„ä¸­æ–‡å­—ç¬¦æ—¶ï¼š
1. å­—ç¬¦ä¼šåœ¨ä¸‹æ¬¡æ„å»ºæ—¶è‡ªåŠ¨è¢«æå–
2. å­—ä½“å­é›†ä¼šè‡ªåŠ¨æ›´æ–°åŒ…å«æ–°å­—ç¬¦
3. æ— éœ€æ‰‹åŠ¨å¹²é¢„

### æ·»åŠ æ–°å­—ä½“
è¦æ·»åŠ æ–°çš„å­—ä½“æ–‡ä»¶ï¼Œç¼–è¾‘ `scripts/build-font-subset.mjs`ï¼š

```javascript
const CONFIG = {
  fonts: [
    {
      input: 'YourNewFont-Regular.otf',
      output: 'YourNewFont-Regular-subset.woff2'
    },
    // ... å…¶ä»–å­—ä½“
  ]
};
```

## ğŸ”§ ä¾èµ–è¦æ±‚

### æœ¬åœ°å¼€å‘
```bash
# å®‰è£… fonttools
pip install "fonttools[woff]"
```

### CI/CD ç¯å¢ƒ
GitHub Actions ä¼šè‡ªåŠ¨å®‰è£…ä»¥ä¸‹ä¾èµ–ï¼š
- Python 3.x
- fonttools[woff]

## âš™ï¸ é…ç½®è¯´æ˜

### è„šæœ¬é…ç½® (scripts/build-font-subset.mjs)
```javascript
const CONFIG = {
  sourceDir: './src',                    // æºç ç›®å½•
  fontsDir: './public/fonts',            // åŸå§‹å­—ä½“ç›®å½•
  subsetDir: './public/fonts/subset',    // è¾“å‡ºç›®å½•
  charsFile: './temp-chars.txt',         // ä¸´æ—¶å­—ç¬¦æ–‡ä»¶
  fonts: [...]                          // å­—ä½“é…ç½®
};
```

### æ„å»ºè„šæœ¬ (package.json)
```json
{
  "scripts": {
    "build": "npm run build:fonts && next build",
    "build:fonts": "node scripts/build-font-subset.mjs"
  }
}
```

## ğŸ“Š æ€§èƒ½ç›‘æ§

æ„å»ºæ—¶ä¼šè¾“å‡ºè¯¦ç»†çš„ä¼˜åŒ–æŠ¥å‘Šï¼š
```
ğŸ“¦ å¤„ç† SourceHanSerifCN-Medium.otf (12.3MB)...
  âœ“ SourceHanSerifCN-Medium-subset.woff2 åˆ›å»ºæˆåŠŸ
  ğŸ“Š 12.3MB â†’ 127KB (å‡å°‘ 99.0%)
```

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **å­—ä½“æ–‡ä»¶è·¯å¾„**: ç¡®ä¿åŸå§‹å­—ä½“æ–‡ä»¶å­˜åœ¨äº `public/fonts/` ç›®å½•
2. **Python ä¾èµ–**: æ„å»ºç¯å¢ƒéœ€è¦å®‰è£… `fonttools`
3. **å­—ç¬¦è¦†ç›–**: æ–°æ·»åŠ çš„å­—ç¬¦éœ€è¦é‡æ–°æ„å»ºæ‰èƒ½ç”Ÿæ•ˆ
4. **ç‰ˆæœ¬æ§åˆ¶**: ç”Ÿæˆçš„å­é›†å­—ä½“æ–‡ä»¶ä¸ä¼šè¢«æäº¤åˆ° Git

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: æ„å»ºæ—¶æŠ¥é”™ "ç¼ºå°‘ pyftsubset å·¥å…·"**
```bash
# å®‰è£… fonttools
pip install "fonttools[woff]"

# æˆ–è€…ä½¿ç”¨ conda
conda install fonttools
```

**Q: å­—ä½“æ–‡ä»¶æ²¡æœ‰ç”Ÿæˆ**
- æ£€æŸ¥åŸå§‹å­—ä½“æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- ç¡®è®¤ `public/fonts/` ç›®å½•ç»“æ„æ­£ç¡®
- æŸ¥çœ‹æ„å»ºæ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

**Q: ç½‘ç«™æ˜¾ç¤ºå­—ä½“å¼‚å¸¸**
- ç¡®è®¤æ–°å­—ç¬¦å·²è¢«æå–åˆ°å­—ç¬¦åˆ—è¡¨ä¸­
- é‡æ–°è¿è¡Œ `npm run build:fonts`
- æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­çš„å­—ä½“åŠ è½½çŠ¶æ€

### è°ƒè¯•æ¨¡å¼

ä¿®æ”¹è„šæœ¬ä¸­çš„æ—¥å¿—çº§åˆ«æ¥è·å–æ›´å¤šä¿¡æ¯ï¼š
```javascript
// åœ¨ createFontSubsets å‡½æ•°ä¸­
execSync(command, { stdio: 'inherit' }); // æ˜¾ç¤ºè¯¦ç»†è¾“å‡º
```

## ğŸ“ˆ ä¼˜åŒ–å»ºè®®

1. **å®šæœŸç»´æŠ¤**: å®šæœŸæ£€æŸ¥æ˜¯å¦æœ‰æœªä½¿ç”¨çš„å­—ç¬¦å¯ä»¥ç§»é™¤
2. **å­—ä½“æ ¼å¼**: ä¼˜å…ˆä½¿ç”¨ WOFF2 æ ¼å¼è·å¾—æœ€ä½³å‹ç¼©ç‡
3. **ç¼“å­˜ç­–ç•¥**: åœ¨ CDN ä¸­ä¸ºå­—ä½“æ–‡ä»¶è®¾ç½®é•¿æœŸç¼“å­˜
4. **é¢„åŠ è½½**: ä½¿ç”¨ `<link rel="preload">` é¢„åŠ è½½å…³é”®å­—ä½“

## ğŸ”— ç›¸å…³é“¾æ¥

- [fonttools æ–‡æ¡£](https://fonttools.readthedocs.io/)
- [WOFF2 è§„èŒƒ](https://www.w3.org/TR/WOFF2/)
- [å­—ä½“ä¼˜åŒ–æœ€ä½³å®è·µ](https://web.dev/font-best-practices/) 